async function aesGcmEncrypt(e,t){let a=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",a),r=crypto.getRandomValues(new Uint8Array(12)),c=Array.from(r).map(e=>String.fromCharCode(e)).join(""),o={name:"AES-GCM",iv:r},i=await crypto.subtle.importKey("raw",n,o,!1,["encrypt"]),m=new TextEncoder().encode(e),w=await crypto.subtle.encrypt(o,i,m),d=Array.from(new Uint8Array(w)),s=d.map(e=>String.fromCharCode(e)).join("");return btoa(c+s)}async function aesGcmDecrypt(e,t){let a=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",a),r=atob(e).slice(0,12),c=new Uint8Array(Array.from(r).map(e=>e.charCodeAt(0))),o={name:"AES-GCM",iv:c},i=await crypto.subtle.importKey("raw",n,o,!1,["decrypt"]),m=atob(e).slice(12),w=new Uint8Array(Array.from(m).map(e=>e.charCodeAt(0)));try{let d=await crypto.subtle.decrypt(o,i,w),s=new TextDecoder().decode(d);return s}catch(l){throw Error("Decrypt failed")}}